(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/components/goodDetail"],{"3a90":function(o,t,e){"use strict";(function(o,i){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=e("cfa1"),a=function(){return Promise.all([e.e("common/vendor"),e.e("components/uni-rich/parse")]).then(e.bind(null,"0aed"))},s={components:{uParse:a},data:function(){return{navList:["商品","评价","详情","推荐"],goods_id:"",navIndex:0,top:0,indicatorDots:!0,autoplay:!0,interval:3e3,duration:2e3,indicatorActiveColor:"#fff",swiperList:[],isShowTop:!0,detail:{},specData:{},select_arr:[],select_name:[],spec_sku_id:0,goods:{},strings:"",goods_num:1,isCar:!1,comment_data:[],comment_data_count:"",showPanic:!1,coverShow:!1,activeColor:"",normShow:!1,title:"",percent:0,activityStart:"",countDownTime:""}},onLoad:function(t){console.log(o("分享文章详情页接受到的参数",t," at pages\\components\\goodDetail.vue:272")),this.goods_id=t.goods_id,"true"===t.panic&&(this.showPanic=!0,this.title=t.title,this.activeColor="秒杀购"===t.title?"#F4433D":"#F4A03D"),this.getDetail()},computed:{statusBarHeight:function(){return this.$store.state.statusBarHeight}},methods:{getDetail:function(){var t=this,e=t.$api.goods_detail;t.showPanic&&("限时购"===t.title?e=t.$api.flashsale_detail:"秒杀购"===t.title&&(e=t.$api.seckill_detail)),t.$http({url:e,data:{goods_id:t.goods_id},cb:function(e,a){if(e||1!==a.code)0===a.code||-1===a.code&&a.msg?i.showToast({title:a.msg,icon:"none"}):i.showToast({title:"商品详情加载失败",icon:"none"});else{console.log(o(a.data.detail," at pages\\components\\goodDetail.vue:308")),t.detail=a.data.detail,t.comment_data=t.detail.comment_data,t.comment_data_count=t.detail.comment_data_count,t.swiperList=t.detail.image,t.specData=a.data.specData;var s=a.data.detail;if(t.percent=Math.ceil((s.total_inventory-s.surplus_inventory)/s.total_inventory*100),s.activity_starttime&&(new Date(s.activity_starttime)>new Date?(s.activityStart=!1,(0,n.countDown)(s.activity_endtime,function(o){t.countDownTime=o})):(t.activityStart=!0,(0,n.countDown)(s.activity_endtime,function(o){t.countDownTime=o}))),t.specData){var c={};c.goods_price=t.specData.spec_list[0].form.goods_price,t.specData.spec_list[0].form.image_path?c.image_path=t.specData.spec_list[0].form.image_path:c.image_path=t.swiperList[0].file_path,c.stock_num=t.specData.spec_list[0].form.stock_num,t.goods=c,t.specData.spec_attr.map(function(o,e){t.select_arr.push(o.spec_items[0].item_id),t.select_name.push(o.spec_items[0].spec_value)})}}}})},selectNorm:function(t,e,i){var n=this;console.log(o(t,e,i," at pages\\components\\goodDetail.vue:369")),n.select_arr[t]=e.item_id;var a=[],s=[];n.select_arr.map(function(o,i){i===t?a.push(e.item_id):a.push(o)}),n.select_arr=a,n.select_name.map(function(o,i){i===t?s.push(e.spec_value):s.push(o)}),n.select_name=s,console.log(o("选中的规格id",a,"选中的规格名称",s," at pages\\components\\goodDetail.vue:394"));var c=n.select_arr.join("_"),d=n.goods;n.specData.spec_list.map(function(o,t){o.spec_sku_id===c&&(d.goods_price=o.form.goods_price,d.stock_num=o.form.stock_num,o.form.image_path&&(d.image_path=o.form.image_path))}),n.goods=d},controlNum:function(o){if("+"===o){if(this.goods_num>=this.goods.stock_num)return void i.showToast({title:"库存不足",icon:"none"});this.goods_num+=1}"-"===o&&this.goods_num>1&&(this.goods_num-=1)},outAddcar:function(){this.isCar=!0,this.normShow=!0},buyNow:function(){this.normShow=!0},toBuy:function(){var t=this;t.$http({url:t.$api.buyNowinventory,data:{goods_id:t.goods_id,goods_num:t.goods_num,goods_sku_id:t.spec_sku_id},cb:function(e,n){if(e||1!==n.code)0===n.code||-1===n.code&&n.msg?i.showToast({title:n.msg,icon:"none"}):i.showToast({title:"检测库存失败",icon:"none"});else{console.log(o("库存充足"," at pages\\components\\goodDetail.vue:453"));var a={goods_id:t.goods_id,goods_num:t.goods_num,goods_sku_id:t.spec_sku_id,panic:t.showPanic,title:t.title};i.navigateTo({url:"../order/submitOrder?data="+JSON.stringify(a)})}}})},addCar:function(){var o=this,t={goods_sku_id:o.select_arr.length>0?o.select_arr.join("_"):0,goods_id:o.goods_id,goods_num:o.goods_num};o.$http({url:o.$api.addcar,method:"POST",data:t,cb:function(t,e){t||1!==e.code?0===e.code||-1===e.code&&e.msg?i.showToast({title:e.msg,icon:"none"}):i.showToast({title:"加入购物车失败",icon:"none"}):(i.showToast({title:"添加成功",icon:"none"}),o.normShow=!1)}})},closeNorm:function(){this.normShow=!1,this.isCar=!1},goBack:function(){i.navigateBack({delta:1})},navAction:function(o){this.navIndex=o},goShare:function(){i.share({provider:"weixin",scene:"WXSceneSession",type:0,href:"http://uniapp.dcloud.io/",title:"uni-app分享",summary:"我正在使用HBuilderX开发uni-app，赶紧跟我一起来体验！",imageUrl:"https://img-cdn-qiniu.dcloud.net.cn/uniapp/images/uni@2x.png",success:function(t){console.log(o("success:"+JSON.stringify(t)," at pages\\components\\goodDetail.vue:539"))},fail:function(t){console.log(o("fail:"+JSON.stringify(t)," at pages\\components\\goodDetail.vue:542"))}})},keepAction:function(){var t=this;console.log(o("点击了收藏",t.detail.goods_iscollection,t.detail.goods_id," at pages\\components\\goodDetail.vue:549"));var e=t.detail.goods_iscollection,i={type:"add",goods_id:t.detail.goods_id};"yes"===e&&(i.type="cancel"),t.$http({url:t.$api.goodscollection,data:i,cb:function(i,n){console.log(o(n," at pages\\components\\goodDetail.vue:562")),t.$resFilter(i,n)&&(t.detail.goods_iscollection="yes"===e?"no":"yes")}})},scroll:function(o){this.top=o.detail.scrollTop,o.detail.scrollTop>375?this.isShowTop=!1:o.detail.scrollTop<=375&&(this.isShowTop=!0)},lookInfo:function(){this.coverShow=!0},goShopcar:function(){i.switchTab({url:"../shopcar/shopcar"})}}};t.default=s}).call(this,e("0de9")["default"],e("6e42")["default"])},5397:function(o,t,e){"use strict";e.r(t);var i=e("3a90"),n=e.n(i);for(var a in i)"default"!==a&&function(o){e.d(t,o,function(){return i[o]})}(a);t["default"]=n.a},"5f7f":function(o,t,e){"use strict";var i=function(){var o=this,t=o.$createElement;o._self._c;o._isMounted||(o.e0=function(t){o.normShow=!0},o.e1=function(t){o.normShow=!1})},n=[];e.d(t,"a",function(){return i}),e.d(t,"b",function(){return n})},"68d7":function(o,t,e){},"7e86":function(o,t,e){"use strict";e.r(t);var i=e("5f7f"),n=e("5397");for(var a in n)"default"!==a&&function(o){e.d(t,o,function(){return n[o]})}(a);e("dba4");var s=e("2877"),c=Object(s["a"])(n["default"],i["a"],i["b"],!1,null,"2be60f4f",null);t["default"]=c.exports},dba4:function(o,t,e){"use strict";var i=e("68d7"),n=e.n(i);n.a}},[["46e7","common/runtime","common/vendor"]]]);